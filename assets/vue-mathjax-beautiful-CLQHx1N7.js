import{d as Te,r as z,c as E,w as G,j as c,o as Me,z as y,C as Le,n as R,k as t,t as S,u as p,q as Ne,J as Ue,y as ze,F as ee,B as se,A as De,M as Ce,N as Je,O as ae,x as d,b as je,L as Ve}from"./vendor-BFUv-uwv.js";const Oe=[{pattern:new RegExp("(?<!\\$)\\$(?!\\$)([^\\$]+)\\$(?!\\$)","g"),wrapper:u=>`\\(${u}\\)`,isInline:!0},{pattern:/\$\$([\s\S]+?)\$\$/g,wrapper:u=>`\\[${u}\\]`,isInline:!1},{pattern:/\\\(([\s\S]+?)\\\)/g,wrapper:u=>`\\(${u}\\)`,isInline:!0},{pattern:/\\\[([\s\S]+?)\\\]/g,wrapper:u=>`\\[${u}\\]`,isInline:!1},{pattern:/\\begin\{equation\}([\s\S]+?)\\end\{equation\}/g,wrapper:u=>`\\[${u}\\]`,isInline:!1},{pattern:/\\begin\{align\}([\s\S]+?)\\end\{align\}/g,wrapper:u=>`\\[${u}\\]`,isInline:!1}];function Ge(u){if(!u)return[];const g=[];return Oe.forEach(({pattern:e,wrapper:o,isInline:s})=>{let x;for(;(x=e.exec(u))!==null;)g.push({formula:x[0],content:x[1],start:x.index,end:x.index+x[0].length,wrapper:o(x[1]),isInline:s})}),g.sort((e,o)=>e.start-o.start)}async function we(u){var g;if(!u)return"";try{u.includes("<svg")&&u.includes("data-latex")&&(u=Ae(u));const e=Ge(u);if(!e.length)return u;let o=u,s=0;for(const x of e)try{if(!((g=window.MathJax)!=null&&g.tex2svgPromise)){console.warn("MathJax not available, skipping formula:",x.content);continue}const k=await window.MathJax.tex2svgPromise(x.content,{display:!x.isInline,scale:1.2,em:16,ex:8,containerWidth:1200});if(!k||typeof k.getElementsByTagName!="function"){console.warn("Invalid SVG object returned from MathJax:",k);continue}const P=k.getElementsByTagName("svg");if(!P||P.length===0){console.warn("No SVG elements found in MathJax output");continue}const h=P[0];h.setAttribute("data-latex",x.content),h.setAttribute("data-latex-type",x.isInline?"inline":"display"),h.setAttribute("contenteditable","false"),h.style.cursor="pointer",h.style.display="inline-block",h.style.margin="0 2px",h.style.fontSize="18px",h.style.verticalAlign="middle";const C="​"+h.outerHTML+"​",B=x.start+s,I=x.end+s;o=o.substring(0,B)+C+o.substring(I),s+=C.length-x.formula.length}catch(k){console.warn("convert latex error:",x.formula,k);continue}return o}catch(e){return console.error("convert latex error:",e),u}}function Ae(u){if(!u)return"";if(!u.includes("<svg"))return u;if(typeof window>"u")return u.replace(/<svg[^>]*data-latex="([^"]*)"[^>]*data-latex-type="([^"]*)"[^>]*>[\s\S]*?<\/svg>/g,(g,e,o)=>o==="inline"?`$${e}$`:`$$${e}$$`).replace(/<svg[^>]*data-latex="([^"]*)"[^>]*>[\s\S]*?<\/svg>/g,(g,e)=>`$$${e}$$`);try{const g=document.createElement("div");return g.innerHTML=u,g.querySelectorAll("svg[data-latex]").forEach(e=>{var o;const s=e.getAttribute("data-latex");if(s){const x=e.getAttribute("data-latex-type");let k;x==="inline"?k=`$${s}$`:k=`$$${s}$$`;const P=document.createTextNode(k);(o=e.parentNode)==null||o.replaceChild(P,e)}}),g.innerHTML}catch(g){return console.error("Extract LaTeX from SVG error:",g),u}}async function xe(u){var g,e,o,s,x;if(!(typeof window>"u")&&(document.querySelectorAll('script[src*="mathjax"]').forEach(k=>k.remove()),window.MathJax&&delete window.MathJax,!((g=window.MathJax)!=null&&g.tex2svgPromise))){window.MathJax||(window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0},svg:{fontCache:"global"}});try{await We();let k=0;const P=100;for(;!((e=window.MathJax)!=null&&e.tex2svgPromise)&&k<P;)await new Promise(h=>setTimeout(h,100)),k++;if(!((o=window.MathJax)!=null&&o.tex2svgPromise))throw document.querySelectorAll('script[src*="mathjax"]').forEach(h=>h.remove()),console.error("MathJax initialization failed. Final state:",{exists:!!window.MathJax,tex2svgPromise:!!((s=window.MathJax)!=null&&s.tex2svgPromise),startup:!!((x=window.MathJax)!=null&&x.startup),keys:window.MathJax?Object.keys(window.MathJax):[],MathJax:window.MathJax}),new Error("MathJax tex2svgPromise not available after initialization")}catch(k){throw document.querySelectorAll('script[src*="mathjax"]').forEach(P=>P.remove()),console.error("Failed to initialize MathJax:",k),k}}}function Xe(u){return new Promise((g,e)=>{const o=document.createElement("script");o.src=u,o.async=!0,o.id="mathjax-script";const s=setTimeout(()=>{console.warn("MathJax loading timeout for:",u),e(new Error(`Timeout loading MathJax from ${u}`))},1e4);o.onload=()=>{clearTimeout(s),g()},o.onerror=x=>{clearTimeout(s),console.warn("Failed to load MathJax from:",u,x),e(new Error(`Failed to load MathJax from ${u}`))},document.head.appendChild(o)})}async function We(u=["https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"]){if(typeof window>"u")throw new Error("MathJax can only be loaded in browser environment");if(document.querySelectorAll('script[src*="mathjax"]').forEach(o=>o.remove()),window.MathJax&&delete window.MathJax,document.querySelector('script[src*="mathjax"]'))return;const g=[...Array.isArray(u)?u:[u],"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js","https://unpkg.com/mathjax@3/es5/tex-svg.js","https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-svg.min.js"],e=[...new Set(g)];for(const o of e)try{await Xe(o);return}catch(s){console.warn("Failed to load from:",o,s);const x=document.getElementById("mathjax-script");x&&x.remove();continue}throw new Error("Failed to load MathJax from all available CDNs")}const Ke={beautiful:{title:"数学公式编辑器",subtitle:"使用下方按钮或直接输入 LaTeX 代码",inputSection:"LaTeX 输入",previewSection:"实时预览",rendering:"渲染中",noFormula:"无公式",inputPlaceholder:"输入 LaTeX 公式或点击下方符号...",insertButton:"插入公式",cancelButton:"取消",clearButton:"清空",themeToggle:{light:"切换到亮色主题",dark:"切换到暗色主题"},categories:{basic:"基础符号",greek:"希腊字母",advanced:"高级符号",formulas:"常用公式"},examples:{quadratic:"二次方程解",integral:"定积分",sum:"求和公式",fraction:"分数表示",matrix:"矩阵表示",limit:"极限表示"}},editor:{placeholder:"开始编写您的内容...",toolbar:{bold:"粗体",italic:"斜体",underline:"下划线",strikethrough:"删除线",formula:"插入数学公式",formulaShort:"公式",image:"插入图片",imageShort:"图片",clear:"清除格式",clearShort:"清除",theme:"主题"},shortcuts:{bold:"粗体 (Ctrl+B)",italic:"斜体 (Ctrl+I)",underline:"下划线 (Ctrl+U)",clear:"清除格式 (Ctrl+Shift+X)"},stats:{characters:"字符",words:"单词"},messages:{imageError:"图片上传失败",imageTooBig:"文件过大，最大允许",unsupportedType:"不支持的文件类型",mathjaxNotLoaded:"MathJax未加载",renderFailed:"渲染失败"}}},Qe={beautiful:{title:"Math Formula Editor",subtitle:"Use buttons below or directly input LaTeX code",inputSection:"LaTeX Input",previewSection:"Live Preview",rendering:"Rendering",noFormula:"No Formula",inputPlaceholder:"Input LaTeX formula or click symbols below...",insertButton:"Insert Formula",cancelButton:"Cancel",clearButton:"Clear",themeToggle:{light:"Switch to Light Theme",dark:"Switch to Dark Theme"},categories:{basic:"Basic Symbols",greek:"Greek Letters",advanced:"Advanced Symbols",formulas:"Common Formulas"},examples:{quadratic:"Quadratic Formula",integral:"Definite Integral",sum:"Summation Formula",fraction:"Fraction Notation",matrix:"Matrix Notation",limit:"Limit Notation"}},editor:{placeholder:"Start writing your content...",toolbar:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",formula:"Insert Math Formula",formulaShort:"Formula",image:"Insert Image",imageShort:"Image",clear:"Clear Format",clearShort:"Clear",theme:"Theme"},shortcuts:{bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",underline:"Underline (Ctrl+U)",clear:"Clear Format (Ctrl+Shift+X)"},stats:{characters:"characters",words:"words"},messages:{imageError:"Image upload failed",imageTooBig:"File too large, maximum allowed",unsupportedType:"Unsupported file type",mathjaxNotLoaded:"MathJax not loaded",renderFailed:"Render failed"}}},Ze={"zh-CN":Ke,"en-US":Qe},ge=z("zh-CN");function _e(){const u=E(()=>Ze[ge.value]),g=o=>{ge.value=o},e=E(()=>ge.value);return{t:u,locale:e,setLocale:g,availableLocales:[{key:"zh-CN",name:"中文"},{key:"en-US",name:"English"}]}}const Ye=[{latex:"+",description:{"zh-CN":"加号","en-US":"Plus"},display:""},{latex:"-",description:{"zh-CN":"减号","en-US":"Minus"},display:""},{latex:"\\times",description:{"zh-CN":"乘号","en-US":"Times"},display:""},{latex:"\\div",description:{"zh-CN":"除号","en-US":"Division"},display:""},{latex:"\\cdot",description:{"zh-CN":"点乘","en-US":"Dot Product"},display:""},{latex:"\\pm",description:{"zh-CN":"正负号","en-US":"Plus Minus"},display:""},{latex:"\\mp",description:{"zh-CN":"负正号","en-US":"Minus Plus"},display:""},{latex:"=",description:{"zh-CN":"等号","en-US":"Equals"},display:""},{latex:"\\neq",description:{"zh-CN":"不等号","en-US":"Not Equal"},display:""},{latex:"<",description:{"zh-CN":"小于","en-US":"Less Than"},display:""},{latex:">",description:{"zh-CN":"大于","en-US":"Greater Than"},display:""},{latex:"\\leq",description:{"zh-CN":"小于等于","en-US":"Less Equal"},display:""},{latex:"\\geq",description:{"zh-CN":"大于等于","en-US":"Greater Equal"},display:""},{latex:"\\approx",description:{"zh-CN":"约等于","en-US":"Approximately"},display:""},{latex:"\\equiv",description:{"zh-CN":"恒等于","en-US":"Equivalent"},display:""},{latex:"\\propto",description:{"zh-CN":"正比于","en-US":"Proportional"},display:""},{latex:"\\sim",description:{"zh-CN":"相似于","en-US":"Similar"},display:""},{latex:"\\cong",description:{"zh-CN":"全等于","en-US":"Congruent"},display:""},{latex:"x^2",description:{"zh-CN":"平方","en-US":"Square"},display:""},{latex:"x^3",description:{"zh-CN":"立方","en-US":"Cube"},display:""},{latex:"x^{n}",description:{"zh-CN":"通用幂","en-US":"Power"},display:""},{latex:"a_n",description:{"zh-CN":"下标","en-US":"Subscript"},display:""},{latex:"a_{ij}",description:{"zh-CN":"双下标","en-US":"Double Subscript"},display:""},{latex:"x_{n}",description:{"zh-CN":"下标n","en-US":"Subscript n"},display:""},{latex:"\\sqrt{a}",description:{"zh-CN":"平方根","en-US":"Square Root"},display:""},{latex:"\\sqrt[3]{a}",description:{"zh-CN":"立方根","en-US":"Cube Root"},display:""},{latex:"\\sqrt[n]{a}",description:{"zh-CN":"n次根","en-US":"nth Root"},display:""},{latex:"\\sqrt{x}",description:{"zh-CN":"根号x","en-US":"Square Root of x"},display:""},{latex:"\\frac{a}{b}",description:{"zh-CN":"通用分数","en-US":"Fraction"},display:""},{latex:"\\frac{1}{x}",description:{"zh-CN":"倒数","en-US":"Reciprocal"},display:""},{latex:"\\frac{1}{x^2}",description:{"zh-CN":"平方倒数","en-US":"Square Reciprocal"},display:""},{latex:"\\frac{x^2}{y^2}",description:{"zh-CN":"平方分数","en-US":"Square Fraction"},display:""},{latex:"\\int",description:{"zh-CN":"积分","en-US":"Integral"},display:""},{latex:"\\int_{a}^{b}",description:{"zh-CN":"定积分","en-US":"Definite Integral"},display:""},{latex:"\\int_{a}^{b} f(x) dx",description:{"zh-CN":"定积分完整形式","en-US":"Complete Definite Integral"},display:""},{latex:"\\oint",description:{"zh-CN":"环积分","en-US":"Contour Integral"},display:""},{latex:"\\sum",description:{"zh-CN":"求和","en-US":"Summation"},display:""},{latex:"\\sum_{i=1}^{n}",description:{"zh-CN":"求和1到n","en-US":"Sum from 1 to n"},display:""},{latex:"\\sum_{i=0}^{\\infty}",description:{"zh-CN":"无穷求和","en-US":"Infinite Sum"},display:""},{latex:"\\prod",description:{"zh-CN":"连乘","en-US":"Product"},display:""},{latex:"\\prod_{i=1}^{n}",description:{"zh-CN":"乘积1到n","en-US":"Product from 1 to n"},display:""},{latex:"\\frac{dx}{dy}",description:{"zh-CN":"导数","en-US":"Derivative"},display:""},{latex:"\\frac{\\partial x}{\\partial y}",description:{"zh-CN":"偏导数","en-US":"Partial Derivative"},display:""},{latex:"f'(x)",description:{"zh-CN":"导数符号","en-US":"Derivative Notation"},display:""},{latex:"f^{(n)}(x)",description:{"zh-CN":"n阶导数","en-US":"nth Derivative"},display:""},{latex:"\\partial",description:{"zh-CN":"偏导符号","en-US":"Partial Symbol"},display:""},{latex:"\\nabla",description:{"zh-CN":"梯度","en-US":"Gradient"},display:""},{latex:"\\lim",description:{"zh-CN":"极限","en-US":"Limit"},display:""},{latex:"\\lim_{x \\to a}",description:{"zh-CN":"极限x趋于a","en-US":"Limit x approaches a"},display:""},{latex:"\\lim_{x \\to \\infty}",description:{"zh-CN":"无穷极限","en-US":"Infinite Limit"},display:""},{latex:"\\lim_{x \\to 0^+}",description:{"zh-CN":"右极限","en-US":"Right Limit"},display:""},{latex:"\\lim_{x \\to 0^-}",description:{"zh-CN":"左极限","en-US":"Left Limit"},display:""},{latex:"\\sin",description:{"zh-CN":"正弦","en-US":"Sine"},display:""},{latex:"\\cos",description:{"zh-CN":"余弦","en-US":"Cosine"},display:""},{latex:"\\tan",description:{"zh-CN":"正切","en-US":"Tangent"},display:""},{latex:"\\cot",description:{"zh-CN":"余切","en-US":"Cotangent"},display:""},{latex:"\\sec",description:{"zh-CN":"正割","en-US":"Secant"},display:""},{latex:"\\csc",description:{"zh-CN":"余割","en-US":"Cosecant"},display:""},{latex:"\\arcsin",description:{"zh-CN":"反正弦","en-US":"Arcsine"},display:""},{latex:"\\arccos",description:{"zh-CN":"反余弦","en-US":"Arccosine"},display:""},{latex:"\\arctan",description:{"zh-CN":"反正切","en-US":"Arctangent"},display:""},{latex:"\\log",description:{"zh-CN":"对数","en-US":"Logarithm"},display:""},{latex:"\\ln",description:{"zh-CN":"自然对数","en-US":"Natural Log"},display:""},{latex:"\\log_a b",description:{"zh-CN":"以a为底的对数","en-US":"Log base a of b"},display:""},{latex:"\\log_{10}",description:{"zh-CN":"常用对数","en-US":"Common Log"},display:""},{latex:"e^x",description:{"zh-CN":"自然指数","en-US":"Natural Exponential"},display:""},{latex:"a^{bc}",description:{"zh-CN":"复合指数","en-US":"Compound Exponent"},display:""},{latex:"\\exp",description:{"zh-CN":"指数函数","en-US":"Exponential Function"},display:""},{latex:"[x]",description:{"zh-CN":"方括号","en-US":"Square Brackets"},display:""},{latex:"(x)",description:{"zh-CN":"圆括号","en-US":"Parentheses"},display:""},{latex:"\\{x\\}",description:{"zh-CN":"花括号","en-US":"Curly Braces"},display:""},{latex:"|x|",description:{"zh-CN":"绝对值","en-US":"Absolute Value"},display:""},{latex:"\\|x\\|",description:{"zh-CN":"范数","en-US":"Norm"},display:""},{latex:"\\infty",description:{"zh-CN":"无穷大","en-US":"Infinity"},display:""},{latex:"\\pi",description:{"zh-CN":"圆周率","en-US":"Pi"},display:""},{latex:"e",description:{"zh-CN":"自然常数","en-US":"Euler Number"},display:""},{latex:"\\angle",description:{"zh-CN":"角","en-US":"Angle"},display:""},{latex:"\\perp",description:{"zh-CN":"垂直","en-US":"Perpendicular"},display:""},{latex:"\\parallel",description:{"zh-CN":"平行","en-US":"Parallel"},display:""},{latex:"^\\circ",description:{"zh-CN":"度数符号","en-US":"Degree Symbol"},display:""},{latex:"\\%",description:{"zh-CN":"百分号","en-US":"Percent"},display:""},{latex:"\\vec{a}",description:{"zh-CN":"向量","en-US":"Vector"},display:""},{latex:"\\overline{AB}",description:{"zh-CN":"上划线","en-US":"Overline"},display:""},{latex:"\\overrightarrow{AB}",description:{"zh-CN":"向量AB","en-US":"Vector AB"},display:""},{latex:"\\hat{a}",description:{"zh-CN":"单位向量","en-US":"Unit Vector"},display:""},{latex:"0",description:{"zh-CN":"数字0","en-US":"Number 0"},display:""},{latex:"1",description:{"zh-CN":"数字1","en-US":"Number 1"},display:""},{latex:"2",description:{"zh-CN":"数字2","en-US":"Number 2"},display:""},{latex:"3",description:{"zh-CN":"数字3","en-US":"Number 3"},display:""},{latex:"4",description:{"zh-CN":"数字4","en-US":"Number 4"},display:""},{latex:"5",description:{"zh-CN":"数字5","en-US":"Number 5"},display:""},{latex:"6",description:{"zh-CN":"数字6","en-US":"Number 6"},display:""},{latex:"7",description:{"zh-CN":"数字7","en-US":"Number 7"},display:""},{latex:"8",description:{"zh-CN":"数字8","en-US":"Number 8"},display:""},{latex:"9",description:{"zh-CN":"数字9","en-US":"Number 9"},display:""},{latex:".",description:{"zh-CN":"小数点","en-US":"Decimal Point"},display:""}],ea=[{latex:"\\alpha",description:{"zh-CN":"阿尔法","en-US":"Alpha"},display:""},{latex:"\\beta",description:{"zh-CN":"贝塔","en-US":"Beta"},display:""},{latex:"\\gamma",description:{"zh-CN":"伽马","en-US":"Gamma"},display:""},{latex:"\\delta",description:{"zh-CN":"德尔塔","en-US":"Delta"},display:""},{latex:"\\epsilon",description:{"zh-CN":"爱普西隆","en-US":"Epsilon"},display:""},{latex:"\\varepsilon",description:{"zh-CN":"爱普西隆变体","en-US":"Var Epsilon"},display:""},{latex:"\\zeta",description:{"zh-CN":"泽塔","en-US":"Zeta"},display:""},{latex:"\\eta",description:{"zh-CN":"艾塔","en-US":"Eta"},display:""},{latex:"\\theta",description:{"zh-CN":"西塔","en-US":"Theta"},display:""},{latex:"\\vartheta",description:{"zh-CN":"西塔变体","en-US":"Var Theta"},display:""},{latex:"\\iota",description:{"zh-CN":"约塔","en-US":"Iota"},display:""},{latex:"\\kappa",description:{"zh-CN":"卡帕","en-US":"Kappa"},display:""},{latex:"\\lambda",description:{"zh-CN":"兰布达","en-US":"Lambda"},display:""},{latex:"\\mu",description:{"zh-CN":"缪","en-US":"Mu"},display:""},{latex:"\\nu",description:{"zh-CN":"纽","en-US":"Nu"},display:""},{latex:"\\xi",description:{"zh-CN":"克西","en-US":"Xi"},display:""},{latex:"o",description:{"zh-CN":"欧米克隆","en-US":"Omicron"},display:""},{latex:"\\pi",description:{"zh-CN":"派","en-US":"Pi"},display:""},{latex:"\\varpi",description:{"zh-CN":"派变体","en-US":"Var Pi"},display:""},{latex:"\\rho",description:{"zh-CN":"洛","en-US":"Rho"},display:""},{latex:"\\varrho",description:{"zh-CN":"洛变体","en-US":"Var Rho"},display:""},{latex:"\\sigma",description:{"zh-CN":"西格马","en-US":"Sigma"},display:""},{latex:"\\varsigma",description:{"zh-CN":"西格马尾字母","en-US":"Final Sigma"},display:""},{latex:"\\tau",description:{"zh-CN":"陶","en-US":"Tau"},display:""},{latex:"\\upsilon",description:{"zh-CN":"厄普西隆","en-US":"Upsilon"},display:""},{latex:"\\phi",description:{"zh-CN":"斐","en-US":"Phi"},display:""},{latex:"\\varphi",description:{"zh-CN":"斐变体","en-US":"Var Phi"},display:""},{latex:"\\chi",description:{"zh-CN":"卡","en-US":"Chi"},display:""},{latex:"\\psi",description:{"zh-CN":"普西","en-US":"Psi"},display:""},{latex:"\\omega",description:{"zh-CN":"欧米伽","en-US":"Omega"},display:""},{latex:"A",description:{"zh-CN":"阿尔法 (大写)","en-US":"Alpha (Uppercase)"},display:""},{latex:"B",description:{"zh-CN":"贝塔 (大写)","en-US":"Beta (Uppercase)"},display:""},{latex:"\\Gamma",description:{"zh-CN":"伽马 (大写)","en-US":"Gamma (Uppercase)"},display:""},{latex:"\\Delta",description:{"zh-CN":"德尔塔 (大写)","en-US":"Delta (Uppercase)"},display:""},{latex:"E",description:{"zh-CN":"爱普西隆 (大写)","en-US":"Epsilon (Uppercase)"},display:""},{latex:"Z",description:{"zh-CN":"泽塔 (大写)","en-US":"Zeta (Uppercase)"},display:""},{latex:"H",description:{"zh-CN":"艾塔 (大写)","en-US":"Eta (Uppercase)"},display:""},{latex:"\\Theta",description:{"zh-CN":"西塔 (大写)","en-US":"Theta (Uppercase)"},display:""},{latex:"I",description:{"zh-CN":"约塔 (大写)","en-US":"Iota (Uppercase)"},display:""},{latex:"K",description:{"zh-CN":"卡帕 (大写)","en-US":"Kappa (Uppercase)"},display:""},{latex:"\\Lambda",description:{"zh-CN":"兰布达 (大写)","en-US":"Lambda (Uppercase)"},display:""},{latex:"M",description:{"zh-CN":"缪 (大写)","en-US":"Mu (Uppercase)"},display:""},{latex:"N",description:{"zh-CN":"纽 (大写)","en-US":"Nu (Uppercase)"},display:""},{latex:"\\Xi",description:{"zh-CN":"克西 (大写)","en-US":"Xi (Uppercase)"},display:""},{latex:"O",description:{"zh-CN":"欧米克隆 (大写)","en-US":"Omicron (Uppercase)"},display:""},{latex:"\\Pi",description:{"zh-CN":"派 (大写)","en-US":"Pi (Uppercase)"},display:""},{latex:"P",description:{"zh-CN":"洛 (大写)","en-US":"Rho (Uppercase)"},display:""},{latex:"\\Sigma",description:{"zh-CN":"西格马 (大写)","en-US":"Sigma (Uppercase)"},display:""},{latex:"T",description:{"zh-CN":"陶 (大写)","en-US":"Tau (Uppercase)"},display:""},{latex:"\\Upsilon",description:{"zh-CN":"厄普西隆 (大写)","en-US":"Upsilon (Uppercase)"},display:""},{latex:"\\Phi",description:{"zh-CN":"斐 (大写)","en-US":"Phi (Uppercase)"},display:""},{latex:"X",description:{"zh-CN":"卡 (大写)","en-US":"Chi (Uppercase)"},display:""},{latex:"\\Psi",description:{"zh-CN":"普西 (大写)","en-US":"Psi (Uppercase)"},display:""},{latex:"\\Omega",description:{"zh-CN":"欧米伽 (大写)","en-US":"Omega (Uppercase)"},display:""}],aa=[{latex:"\\forall",description:{"zh-CN":"任意","en-US":"For All"},display:""},{latex:"\\exists",description:{"zh-CN":"存在","en-US":"Exists"},display:""},{latex:"\\nexists",description:{"zh-CN":"不存在","en-US":"Not Exists"},display:""},{latex:"\\land",description:{"zh-CN":"逻辑与","en-US":"Logical And"},display:""},{latex:"\\lor",description:{"zh-CN":"逻辑或","en-US":"Logical Or"},display:""},{latex:"\\neg",description:{"zh-CN":"逻辑非","en-US":"Logical Not"},display:""},{latex:"\\implies",description:{"zh-CN":"蕴含","en-US":"Implies"},display:""},{latex:"\\iff",description:{"zh-CN":"当且仅当","en-US":"If and Only If"},display:""},{latex:"\\therefore",description:{"zh-CN":"因此","en-US":"Therefore"},display:""},{latex:"\\because",description:{"zh-CN":"因为","en-US":"Because"},display:""},{latex:"\\in",description:{"zh-CN":"属于","en-US":"Element Of"},display:""},{latex:"\\notin",description:{"zh-CN":"不属于","en-US":"Not Element Of"},display:""},{latex:"\\subset",description:{"zh-CN":"子集","en-US":"Subset"},display:""},{latex:"\\supset",description:{"zh-CN":"超集","en-US":"Superset"},display:""},{latex:"\\subseteq",description:{"zh-CN":"子集或相等","en-US":"Subset or Equal"},display:""},{latex:"\\supseteq",description:{"zh-CN":"超集或相等","en-US":"Superset or Equal"},display:""},{latex:"\\cup",description:{"zh-CN":"并集","en-US":"Union"},display:""},{latex:"\\cap",description:{"zh-CN":"交集","en-US":"Intersection"},display:""},{latex:"\\setminus",description:{"zh-CN":"集合差","en-US":"Set Difference"},display:""},{latex:"\\emptyset",description:{"zh-CN":"空集","en-US":"Empty Set"},display:""},{latex:"\\mathbb{N}",description:{"zh-CN":"自然数集","en-US":"Natural Numbers"},display:""},{latex:"\\mathbb{Z}",description:{"zh-CN":"整数集","en-US":"Integers"},display:""},{latex:"\\mathbb{Q}",description:{"zh-CN":"有理数集","en-US":"Rational Numbers"},display:""},{latex:"\\mathbb{R}",description:{"zh-CN":"实数集","en-US":"Real Numbers"},display:""},{latex:"\\mathbb{C}",description:{"zh-CN":"复数集","en-US":"Complex Numbers"},display:""},{latex:"\\mathbb{P}",description:{"zh-CN":"素数集","en-US":"Prime Numbers"},display:""},{latex:"\\aleph",description:{"zh-CN":"Aleph","en-US":"Aleph"},display:""},{latex:"\\hbar",description:{"zh-CN":"约化普朗克常数","en-US":"Reduced Planck Constant"},display:""},{latex:"\\ell",description:{"zh-CN":"脚本L","en-US":"Script L"},display:""},{latex:"\\wp",description:{"zh-CN":"Weierstrass P","en-US":"Weierstrass P"},display:""},{latex:"\\int",description:{"zh-CN":"积分","en-US":"Integral"},display:""},{latex:"\\iint",description:{"zh-CN":"二重积分","en-US":"Double Integral"},display:""},{latex:"\\iiint",description:{"zh-CN":"三重积分","en-US":"Triple Integral"},display:""},{latex:"\\oint",description:{"zh-CN":"环积分","en-US":"Contour Integral"},display:""},{latex:"\\partial",description:{"zh-CN":"偏导数","en-US":"Partial Derivative"},display:""},{latex:"\\nabla",description:{"zh-CN":"梯度","en-US":"Gradient"},display:""},{latex:"\\sum",description:{"zh-CN":"求和","en-US":"Summation"},display:""},{latex:"\\prod",description:{"zh-CN":"连乘","en-US":"Product"},display:""},{latex:"\\lim",description:{"zh-CN":"极限","en-US":"Limit"},display:""},{latex:"\\sup",description:{"zh-CN":"上确界","en-US":"Supremum"},display:""},{latex:"\\equiv",description:{"zh-CN":"恒等于","en-US":"Equivalent"},display:""},{latex:"\\approx",description:{"zh-CN":"约等于","en-US":"Approximately"},display:""},{latex:"\\sim",description:{"zh-CN":"相似于","en-US":"Similar"},display:""},{latex:"\\simeq",description:{"zh-CN":"渐近相等","en-US":"Asymptotically Equal"},display:""},{latex:"\\cong",description:{"zh-CN":"全等","en-US":"Congruent"},display:""},{latex:"\\propto",description:{"zh-CN":"正比于","en-US":"Proportional"},display:""},{latex:"\\asymp",description:{"zh-CN":"渐近","en-US":"Asymptotic"},display:""},{latex:"\\doteq",description:{"zh-CN":"趋于","en-US":"Approaches"},display:""},{latex:"\\bowtie",description:{"zh-CN":"自然连接","en-US":"Natural Join"},display:""},{latex:"\\models",description:{"zh-CN":"模型","en-US":"Models"},display:""},{latex:"\\rightarrow",description:{"zh-CN":"右箭头","en-US":"Right Arrow"},display:""},{latex:"\\leftarrow",description:{"zh-CN":"左箭头","en-US":"Left Arrow"},display:""},{latex:"\\leftrightarrow",description:{"zh-CN":"双向箭头","en-US":"Bidirectional Arrow"},display:""},{latex:"\\Rightarrow",description:{"zh-CN":"蕴含","en-US":"Implies"},display:""},{latex:"\\Leftarrow",description:{"zh-CN":"被蕴含","en-US":"Is Implied By"},display:""},{latex:"\\Leftrightarrow",description:{"zh-CN":"当且仅当","en-US":"If and Only If"},display:""},{latex:"\\uparrow",description:{"zh-CN":"上箭头","en-US":"Up Arrow"},display:""},{latex:"\\downarrow",description:{"zh-CN":"下箭头","en-US":"Down Arrow"},display:""},{latex:"\\updownarrow",description:{"zh-CN":"上下箭头","en-US":"Up Down Arrow"},display:""},{latex:"\\nearrow",description:{"zh-CN":"东北箭头","en-US":"Northeast Arrow"},display:""},{latex:"\\oplus",description:{"zh-CN":"直和","en-US":"Direct Sum"},display:""},{latex:"\\ominus",description:{"zh-CN":"对称差","en-US":"Symmetric Difference"},display:""},{latex:"\\otimes",description:{"zh-CN":"张量积","en-US":"Tensor Product"},display:""},{latex:"\\oslash",description:{"zh-CN":"圆除","en-US":"Circled Division"},display:""},{latex:"\\odot",description:{"zh-CN":"圆点","en-US":"Circled Dot"},display:""},{latex:"\\circ",description:{"zh-CN":"复合","en-US":"Composition"},display:""},{latex:"\\bullet",description:{"zh-CN":"子弹","en-US":"Bullet"},display:""},{latex:"\\star",description:{"zh-CN":"星号","en-US":"Star"},display:""},{latex:"\\ast",description:{"zh-CN":"星号","en-US":"Asterisk"},display:""},{latex:"\\diamond",description:{"zh-CN":"菱形","en-US":"Diamond"},display:""},{latex:"\\triangle",description:{"zh-CN":"三角形","en-US":"Triangle"},display:""},{latex:"\\square",description:{"zh-CN":"正方形","en-US":"Square"},display:""},{latex:"\\angle",description:{"zh-CN":"角","en-US":"Angle"},display:""},{latex:"\\parallel",description:{"zh-CN":"平行","en-US":"Parallel"},display:""},{latex:"\\perp",description:{"zh-CN":"垂直","en-US":"Perpendicular"},display:""},{latex:"\\sphericalangle",description:{"zh-CN":"球面角","en-US":"Spherical Angle"},display:""},{latex:"\\measuredangle",description:{"zh-CN":"测量角","en-US":"Measured Angle"},display:""},{latex:"\\infty",description:{"zh-CN":"无穷大","en-US":"Infinity"},display:""},{latex:"\\varnothing",description:{"zh-CN":"空集变体","en-US":"Empty Set Variant"},display:""},{latex:"\\top",description:{"zh-CN":"顶","en-US":"Top"},display:""},{latex:"\\bot",description:{"zh-CN":"底","en-US":"Bottom"},display:""},{latex:"\\vdash",description:{"zh-CN":"证明","en-US":"Proves"},display:""},{latex:"\\dashv",description:{"zh-CN":"反证明","en-US":"Is Proved By"},display:""},{latex:"\\flat",description:{"zh-CN":"降号","en-US":"Flat"},display:""},{latex:"\\natural",description:{"zh-CN":"还原号","en-US":"Natural"},display:""},{latex:"\\sharp",description:{"zh-CN":"升号","en-US":"Sharp"},display:""},{latex:"\\clubsuit",description:{"zh-CN":"梅花","en-US":"Club Suit"},display:""},{latex:"\\diamondsuit",description:{"zh-CN":"方块","en-US":"Diamond Suit"},display:""},{latex:"\\heartsuit",description:{"zh-CN":"红心","en-US":"Heart Suit"},display:""},{latex:"\\spadesuit",description:{"zh-CN":"黑桃","en-US":"Spade Suit"},display:""}],ta=[{latex:"x^2 + y^2 = z^2",description:{"zh-CN":"勾股定理","en-US":"Pythagorean Theorem"},display:""},{latex:"(a + b)^2 = a^2 + 2ab + b^2",description:{"zh-CN":"完全平方公式","en-US":"Perfect Square Formula"},display:""},{latex:"(a - b)^2 = a^2 - 2ab + b^2",description:{"zh-CN":"完全平方差公式","en-US":"Perfect Square Difference"},display:""},{latex:"a^2 - b^2 = (a + b)(a - b)",description:{"zh-CN":"平方差公式","en-US":"Difference of Squares"},display:""},{latex:"\\frac{a}{b} + \\frac{c}{d} = \\frac{ad + bc}{bd}",description:{"zh-CN":"分数加法","en-US":"Fraction Addition"},display:""},{latex:"\\frac{a}{b} \\times \\frac{c}{d} = \\frac{ac}{bd}",description:{"zh-CN":"分数乘法","en-US":"Fraction Multiplication"},display:""},{latex:"\\frac{a}{b} \\div \\frac{c}{d} = \\frac{a}{b} \\times \\frac{d}{c}",description:{"zh-CN":"分数除法","en-US":"Fraction Division"},display:""},{latex:"\\sqrt{a^2 + b^2}",description:{"zh-CN":"平方根公式","en-US":"Square Root Formula"},display:""},{latex:"\\sqrt{ab} = \\sqrt{a} \\cdot \\sqrt{b}",description:{"zh-CN":"根式乘法","en-US":"Radical Multiplication"},display:""},{latex:"\\sqrt[n]{a^m} = a^{\\frac{m}{n}}",description:{"zh-CN":"根式指数化","en-US":"Radical to Exponent"},display:""},{latex:"a^m \\cdot a^n = a^{m+n}",description:{"zh-CN":"同底数幂相乘","en-US":"Product of Powers"},display:""},{latex:"\\frac{a^m}{a^n} = a^{m-n}",description:{"zh-CN":"同底数幂相除","en-US":"Quotient of Powers"},display:""},{latex:"(a^m)^n = a^{mn}",description:{"zh-CN":"幂的乘方","en-US":"Power of a Power"},display:""},{latex:"\\log_a(xy) = \\log_a x + \\log_a y",description:{"zh-CN":"对数乘法法则","en-US":"Logarithm Product Rule"},display:""},{latex:"\\log_a\\left(\\frac{x}{y}\\right) = \\log_a x - \\log_a y",description:{"zh-CN":"对数除法法则","en-US":"Logarithm Quotient Rule"},display:""},{latex:"\\sin^2 x + \\cos^2 x = 1",description:{"zh-CN":"三角恒等式","en-US":"Trigonometric Identity"},display:""},{latex:"\\sin(A + B) = \\sin A \\cos B + \\cos A \\sin B",description:{"zh-CN":"正弦加法公式","en-US":"Sine Addition Formula"},display:""},{latex:"\\cos(A + B) = \\cos A \\cos B - \\sin A \\sin B",description:{"zh-CN":"余弦加法公式","en-US":"Cosine Addition Formula"},display:""},{latex:"\\tan x = \\frac{\\sin x}{\\cos x}",description:{"zh-CN":"正切定义","en-US":"Tangent Definition"},display:""},{latex:"\\lim_{x \\to \\infty} \\frac{1}{x} = 0",description:{"zh-CN":"无穷极限","en-US":"Infinite Limit"},display:""},{latex:"f'(x) = \\lim_{h \\to 0} \\frac{f(x+h) - f(x)}{h}",description:{"zh-CN":"导数定义","en-US":"Derivative Definition"},display:""},{latex:"\\frac{d}{dx}(x^n) = nx^{n-1}",description:{"zh-CN":"幂函数导数","en-US":"Power Rule"},display:""},{latex:"\\int x^n dx = \\frac{x^{n+1}}{n+1} + C",description:{"zh-CN":"幂函数积分","en-US":"Power Rule Integration"},display:""},{latex:"\\int_{a}^{b} f(x) dx",description:{"zh-CN":"定积分","en-US":"Definite Integral"},display:""},{latex:"\\sum_{i=1}^{n} i = \\frac{n(n+1)}{2}",description:{"zh-CN":"等差数列求和","en-US":"Arithmetic Series Sum"},display:""},{latex:"\\sum_{i=1}^{n} i^2 = \\frac{n(n+1)(2n+1)}{6}",description:{"zh-CN":"平方数求和","en-US":"Sum of Squares"},display:""},{latex:"S_n = \\frac{a_1(1-r^n)}{1-r}",description:{"zh-CN":"等比数列求和","en-US":"Geometric Series Sum"},display:""},{latex:"P(A \\cup B) = P(A) + P(B) - P(A \\cap B)",description:{"zh-CN":"概率加法公式","en-US":"Probability Addition Rule"},display:""},{latex:"C_n^r = \\frac{n!}{r!(n-r)!}",description:{"zh-CN":"组合数公式","en-US":"Combination Formula"},display:""},{latex:"\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i",description:{"zh-CN":"算术平均数","en-US":"Arithmetic Mean"},display:""},{latex:"A = \\pi r^2",description:{"zh-CN":"圆面积公式","en-US":"Circle Area Formula"},display:""},{latex:"V = \\frac{4}{3}\\pi r^3",description:{"zh-CN":"球体积公式","en-US":"Sphere Volume Formula"},display:""},{latex:"c^2 = a^2 + b^2 - 2ab\\cos C",description:{"zh-CN":"余弦定理","en-US":"Law of Cosines"},display:""},{latex:"e^{i\\pi} + 1 = 0",description:{"zh-CN":"欧拉公式","en-US":"Euler's Formula"},display:""},{latex:"e = \\lim_{n \\to \\infty} \\left(1 + \\frac{1}{n}\\right)^n",description:{"zh-CN":"自然常数e","en-US":"Euler's Number"},display:""},{latex:"\\zeta(2) = \\sum_{n=1}^{\\infty} \\frac{1}{n^2} = \\frac{\\pi^2}{6}",description:{"zh-CN":"巴塞尔问题","en-US":"Basel Problem"},display:""},{latex:"x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}",description:{"zh-CN":"二次方程求根公式","en-US":"Quadratic Formula"},display:""},{latex:"\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}",description:{"zh-CN":"2×2矩阵","en-US":"2×2 Matrix"},display:""}];function Pe(u,g="zh-CN"){return u[g]||u["zh-CN"]}function oe(u,g="zh-CN"){return Pe(u.description,g)}function ke(u,g="zh-CN"){return Pe(u.name,g)}const la=[{key:"basic",name:{"zh-CN":"基础","en-US":"Basic"},icon:"📋"},{key:"greek",name:{"zh-CN":"希腊字母","en-US":"Greek Letters"},icon:"Ω"},{key:"advanced",name:{"zh-CN":"高级","en-US":"Advanced"},icon:"🎓"}],ia={class:"editor-container"},na={class:"input-section"},ra={class:"section-header"},sa={class:"section-title"},oa={class:"input-actions"},da=["title"],ca=["title"],ua={class:"icon"},pa=["title"],ha={class:"input-wrapper"},ma=["placeholder","readonly","rows","maxlength"],xa={key:0,class:"preview-section"},ya={class:"section-header"},va={class:"section-title"},ga={key:0,class:"status-dot"},Ca={class:"preview-container"},fa=["innerHTML"],Sa={key:1,class:"no-formula"},ba={key:1,class:"symbols-section"},Na={class:"category-tabs"},Ua=["onClick"],za={class:"tab-icon"},wa={class:"tab-name"},ka={class:"symbols-content"},Ta={class:"symbols-grid"},Ma=["onClick","title"],La=["innerHTML"],Aa={key:1,class:"symbol-fallback"},_a={key:0,class:"formula-examples"},Pa={class:"examples-header"},Ba={class:"examples-grid"},$a=["onClick","title"],Ea=["innerHTML"],Ia={class:"example-description"},Fa={class:"inline-footer"},qa=["disabled"],Ra={class:"dialog-header"},Ha={class:"header-content"},Da={class:"header-text"},Ja={class:"header-title"},ja={class:"header-subtitle"},Va={class:"editor-container"},Oa={class:"input-section"},Ga={class:"section-header"},Xa={class:"section-title"},Wa={class:"input-actions"},Ka=["title"],Qa=["title"],Za={class:"icon"},Ya=["title"],et={class:"input-wrapper"},at=["placeholder","readonly","rows","maxlength"],tt={key:0,class:"preview-section"},lt={class:"section-header"},it={class:"section-title"},nt={key:0,class:"status-dot"},rt={class:"preview-container"},st=["innerHTML"],ot={key:1,class:"no-formula"},dt={key:1,class:"symbols-section"},ct={class:"category-tabs"},ut=["onClick"],pt={class:"tab-icon"},ht={class:"tab-name"},mt={class:"symbols-content"},xt={class:"symbols-grid"},yt=["onClick","title"],vt=["innerHTML"],gt={key:1,class:"symbol-fallback"},Ct={key:0,class:"formula-examples"},ft={class:"examples-header"},St={class:"examples-grid"},bt=["onClick","title"],Nt=["innerHTML"],Ut={class:"example-description"},zt={class:"dialog-footer"},wt=["disabled"],kt=Te({__name:"index",props:{modelValue:{type:Boolean,default:!1},existingLatex:{default:""},inlineMode:{type:Boolean,default:!1},theme:{default:"light"},width:{default:"auto"},height:{default:"auto"},scale:{default:1.2},fontSize:{default:"16px"},readonly:{type:Boolean,default:!1},showSymbols:{type:Boolean,default:!0},showPreview:{type:Boolean,default:!0},showThemeToggle:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showFormulaExamples:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},placeholder:{default:""},maxLength:{default:1e3},rows:{default:3},enabledCategories:{default:()=>["basic","greek","advanced"]},defaultCategory:{default:"basic"},insertButtonText:{default:"插入公式"},cancelButtonText:{default:"取消"},clearButtonText:{default:"清空"},title:{default:"数学公式编辑器"},subtitle:{default:"使用下方按钮或直接输入 LaTeX 代码"}},emits:["update:modelValue","insert","change","clear","close","themeChange"],setup(u,{emit:g}){const e=u,o=g,{t:s,locale:x,setLocale:k,availableLocales:P}=_e(),h=z(!1),C=z(""),B=z(e.defaultCategory),I=z(""),M=z(e.theme||"light"),de=z([...Ye]),H=z([...ea]),V=z([...aa]),D=z([...ta]),K=E(()=>la.filter(n=>e.enabledCategories.includes(n.key))),A=E(()=>{switch(B.value){case"greek":return H.value;case"advanced":return V.value;default:return de.value}}),Q=E(()=>{const n={};return e.width!=="auto"&&(n.width=e.width),e.height!=="auto"&&(n.height=e.height),n}),te=E(()=>M.value==="dark"?"☀️":"🌙");E(()=>M.value==="dark"?"切换到亮色主题":"切换到暗色主题");const $=E(()=>e.placeholder||s.value.beautiful.inputPlaceholder);G(()=>e.modelValue,n=>{h.value=n,n&&(C.value=e.existingLatex||"",Z(),he())}),G(()=>e.existingLatex,n=>{(h.value||e.inlineMode)&&n&&(C.value=n,Z())}),G(()=>e.inlineMode,n=>{n&&ae(async()=>{var r;try{(de.value.some(l=>!l.display)||H.value.some(l=>!l.display)||V.value.some(l=>!l.display)||D.value.some(l=>!l.display))&&(r=window.MathJax)!=null&&r.tex2svgPromise&&await Promise.all([O(),me()])}catch(l){console.error("内联模式符号渲染失败:",l)}})},{immediate:!0});const le=z(!1);G(()=>e.theme,n=>{le.value||(M.value=n)},{immediate:!0}),G(M,(n,r)=>{r!==void 0&&(le.value=!0)}),G(()=>e.enabledCategories,n=>{n.includes(B.value)||(B.value=n[0]||"basic")},{immediate:!0});const ye=()=>{ie()},ie=()=>{h.value=!1,o("update:modelValue",!1),o("close"),e.readonly||(C.value="",I.value="")},v=()=>{e.readonly||(C.value="",I.value="",o("clear"),o("change",""))},ne=n=>{if(e.readonly||e.maxLength&&(C.value+n).length>e.maxLength)return;const r=document.querySelector(".latex-input");if(r){const l=r.selectionStart,U=r.selectionEnd,L=C.value;C.value=L.substring(0,l)+n+L.substring(U),ae(()=>{r.focus(),r.selectionStart=r.selectionEnd=l+n.length,Z()})}else C.value+=n,Z()},Z=async()=>{var n,r;if(o("change",C.value),!C.value.trim()){I.value="";return}try{if((n=window.MathJax)!=null&&n.tex2svgPromise||await xe(),!((r=window.MathJax)!=null&&r.tex2svgPromise)){console.error("MathJax初始化失败，无法预览公式"),I.value='<span style="color: red;">MathJax未加载</span>';return}const l=(await window.MathJax.tex2svgPromise(C.value,{display:!1,scale:e.scale})).getElementsByTagName("svg")[0];l?(l.style.fontSize=e.fontSize,l.style.verticalAlign="middle",I.value=l.outerHTML):(console.warn("未获取到SVG元素"),I.value='<span style="color: red;">渲染失败</span>')}catch(l){console.error("LaTeX预览失败:",l);const U=l instanceof Error?l.message:"未知错误";I.value=`<span style="color: red;">预览失败: ${U}</span>`}},ue=()=>{C.value.trim()&&(o("insert",C.value.trim()),e.inlineMode||ie())},pe=()=>{if(!e.showThemeToggle)return;const n=M.value==="dark"?"light":"dark";M.value=n,o("themeChange",n)},J=()=>{const n=x.value==="zh-CN"?"en-US":"zh-CN";k(n)},re=n=>{if(e.readonly){n.preventDefault();return}const r=n.target;let l=r.value;e.maxLength&&l.length>e.maxLength&&(l=l.substring(0,e.maxLength),r.value=l,C.value=l),Z()},he=()=>{e.autoFocus&&ae(()=>{const n=document.querySelector(".latex-input");n&&n.focus()})},X=async n=>{var r;for(let l=0;l<n.length;l++){const U=n[l];if(!U.display){try{if((r=window.MathJax)!=null&&r.tex2svgPromise){const L=(await window.MathJax.tex2svgPromise(U.latex,{display:!1,scale:1.3,em:16,ex:8,containerWidth:1280})).getElementsByTagName("svg")[0];L?(L.style.fontSize="18px",L.style.verticalAlign="middle",L.style.maxWidth="32px",L.style.maxHeight="32px",L.style.width="auto",L.style.height="auto",L.setAttribute("shape-rendering","geometricPrecision"),L.setAttribute("text-rendering","optimizeLegibility"),U.display=L.outerHTML):U.display=""}}catch(L){console.warn(`符号 ${U.latex} 渲染失败:`,L),U.display=""}await new Promise(L=>setTimeout(L,50))}}},O=async()=>{var n;if(!((n=window.MathJax)!=null&&n.tex2svgPromise)){console.warn("MathJax不可用，跳过符号渲染");return}try{await X(de.value),await X(H.value),await X(V.value)}catch(r){console.error("符号渲染过程中出错:",r)}},me=async()=>{var n;if((n=window.MathJax)!=null&&n.tex2svgPromise)for(let r=0;r<D.value.length;r++){const l=D.value[r];if(!l.display){try{const U=(await window.MathJax.tex2svgPromise(l.latex,{display:!1,scale:1,em:16,ex:8,containerWidth:1280})).getElementsByTagName("svg")[0];U?(U.style.fontSize="16px",U.style.maxWidth="100%",U.style.verticalAlign="middle",U.setAttribute("shape-rendering","geometricPrecision"),U.setAttribute("text-rendering","optimizeLegibility"),l.display=U.outerHTML):l.display=""}catch(U){console.warn(`公式示例 ${l.latex} 渲染失败:`,U),l.display=""}await new Promise(U=>setTimeout(U,100))}}};return Me(async()=>{(e.inlineMode||h.value)&&he();try{await xe(),await new Promise(n=>setTimeout(n,300)),await Promise.all([O(),me()])}catch(n){console.error("VueMathjaxBeautiful初始化失败:",n)}}),(n,r)=>(d(),c(ee,null,[n.inlineMode?(d(),c("div",{key:0,class:R(["vue-mathjax-beautiful-inline",{"theme-dark":M.value==="dark","theme-light":M.value==="light"}])},[t("div",ia,[t("div",na,[t("div",ra,[t("div",sa,[r[3]||(r[3]=t("span",{class:"icon"},"📝",-1)),t("span",null,S(p(s).beautiful.inputSection),1)]),t("div",oa,[p(P).length>1?(d(),c("button",{key:0,class:"action-btn",onClick:J,title:p(x)==="zh-CN"?"Switch to English":"切换到中文"},r[4]||(r[4]=[t("span",{class:"icon"},"🌐",-1)]),8,da)):y("",!0),n.showThemeToggle?(d(),c("button",{key:1,class:"action-btn",onClick:pe,title:M.value==="dark"?p(s).beautiful.themeToggle.light:p(s).beautiful.themeToggle.dark},[t("span",ua,S(te.value),1)],8,ca)):y("",!0),n.showClearButton&&!n.readonly?(d(),c("button",{key:2,class:"action-btn",onClick:v,title:p(s).beautiful.clearButton},r[5]||(r[5]=[t("span",{class:"icon"},"🗑️",-1)]),8,pa)):y("",!0)])]),t("div",ha,[Ne(t("textarea",{"onUpdate:modelValue":r[0]||(r[0]=l=>C.value=l),class:"latex-input",placeholder:$.value,readonly:n.readonly,rows:n.rows,maxlength:n.maxLength,onInput:re},null,40,ma),[[Ue,C.value]])])]),n.showPreview?(d(),c("div",xa,[t("div",ya,[t("div",va,[r[6]||(r[6]=t("span",{class:"icon"},"👁️",-1)),t("span",null,S(p(s).beautiful.previewSection),1)]),t("div",{class:R(["preview-status",{active:C.value}])},[C.value?(d(),c("span",ga)):y("",!0),ze(" "+S(C.value?p(s).beautiful.rendering:p(s).beautiful.noFormula),1)],2)]),t("div",Ca,[C.value?(d(),c("div",{key:0,class:"formula-preview",innerHTML:I.value},null,8,fa)):(d(),c("div",Sa,[r[7]||(r[7]=t("span",{class:"icon"},"💡",-1)),t("span",null,S(p(s).beautiful.inputPlaceholder),1)]))])])):y("",!0),n.showSymbols?(d(),c("div",ba,[t("div",Na,[(d(!0),c(ee,null,se(K.value,l=>(d(),c("button",{key:l.key,class:R(["tab-button",{active:B.value===l.key}]),onClick:U=>B.value=l.key},[t("span",za,S(l.icon),1),t("span",wa,S(p(ke)(l,p(x))),1)],10,Ua))),128))]),t("div",ka,[t("div",Ta,[(d(!0),c(ee,null,se(A.value,l=>(d(),c("button",{key:l.latex,class:"symbol-button",onClick:U=>ne(l.latex),title:p(oe)(l,p(x))},[l.display?(d(),c("span",{key:0,innerHTML:l.display},null,8,La)):(d(),c("span",Aa,S(l.latex),1))],8,Ma))),128))]),B.value==="basic"&&n.showFormulaExamples?(d(),c("div",_a,[t("div",Pa,[r[8]||(r[8]=t("span",{class:"icon"},"⭐",-1)),t("span",null,S(p(s).beautiful.categories.formulas),1)]),t("div",Ba,[(d(!0),c(ee,null,se(D.value,l=>(d(),c("button",{key:l.latex,class:"example-button",onClick:U=>ne(l.latex),title:p(oe)(l,p(x))},[t("div",{class:"example-preview",innerHTML:l.display},null,8,Ea),t("div",Ia,S(p(oe)(l,p(x))),1)],8,$a))),128))])])):y("",!0)])])):y("",!0),t("div",Fa,[n.showClearButton&&!n.readonly?(d(),c("button",{key:0,class:"btn btn-secondary",onClick:v},S(p(s).beautiful.clearButton),1)):y("",!0),t("button",{class:"btn btn-primary",onClick:ue,disabled:!C.value||n.readonly},S(p(s).beautiful.insertButton),9,qa)])])],2)):y("",!0),(d(),Le(Je,{to:"body"},[h.value?(d(),c("div",{key:0,class:R(["vue-mathjax-beautiful-overlay",{"theme-dark":M.value==="dark","theme-light":M.value==="light"}]),onClick:ye},[t("div",{class:R(["vue-mathjax-beautiful-dialog",{"theme-dark":M.value==="dark","theme-light":M.value==="light"}]),style:Ce(Q.value),onClick:r[2]||(r[2]=De(()=>{},["stop"]))},[t("div",Ra,[t("div",Ha,[r[9]||(r[9]=t("div",{class:"header-icon"},[t("span",{class:"icon"},"📐")],-1)),t("div",Da,[t("h3",Ja,S(n.title||p(s).beautiful.title),1),t("p",ja,S(n.subtitle||p(s).beautiful.subtitle),1)]),r[10]||(r[10]=t("div",{class:"header-badge"},[t("span",null,"LaTeX")],-1))]),t("button",{class:"close-btn",onClick:ie},r[11]||(r[11]=[t("span",null,"×",-1)]))]),t("div",Va,[t("div",Oa,[t("div",Ga,[t("div",Xa,[r[12]||(r[12]=t("span",{class:"icon"},"📝",-1)),t("span",null,S(p(s).beautiful.inputSection),1)]),t("div",Wa,[p(P).length>1?(d(),c("button",{key:0,class:"action-btn",onClick:J,title:p(x)==="zh-CN"?"Switch to English":"切换到中文"},r[13]||(r[13]=[t("span",{class:"icon"},"🌐",-1)]),8,Ka)):y("",!0),n.showThemeToggle?(d(),c("button",{key:1,class:"action-btn",onClick:pe,title:M.value==="dark"?p(s).beautiful.themeToggle.light:p(s).beautiful.themeToggle.dark},[t("span",Za,S(te.value),1)],8,Qa)):y("",!0),n.showClearButton&&!n.readonly?(d(),c("button",{key:2,class:"action-btn",onClick:v,title:p(s).beautiful.clearButton},r[14]||(r[14]=[t("span",{class:"icon"},"🗑️",-1)]),8,Ya)):y("",!0)])]),t("div",et,[Ne(t("textarea",{"onUpdate:modelValue":r[1]||(r[1]=l=>C.value=l),class:"latex-input",placeholder:$.value,readonly:n.readonly,rows:n.rows,maxlength:n.maxLength,onInput:re},null,40,at),[[Ue,C.value]])])]),n.showPreview?(d(),c("div",tt,[t("div",lt,[t("div",it,[r[15]||(r[15]=t("span",{class:"icon"},"👁️",-1)),t("span",null,S(p(s).beautiful.previewSection),1)]),t("div",{class:R(["preview-status",{active:C.value}])},[C.value?(d(),c("span",nt)):y("",!0),ze(" "+S(C.value?p(s).beautiful.rendering:p(s).beautiful.noFormula),1)],2)]),t("div",rt,[C.value?(d(),c("div",{key:0,class:"formula-preview",innerHTML:I.value},null,8,st)):(d(),c("div",ot,[r[16]||(r[16]=t("span",{class:"icon"},"💡",-1)),t("span",null,S(p(s).beautiful.inputPlaceholder),1)]))])])):y("",!0),n.showSymbols?(d(),c("div",dt,[t("div",ct,[(d(!0),c(ee,null,se(K.value,l=>(d(),c("button",{key:l.key,class:R(["tab-button",{active:B.value===l.key}]),onClick:U=>B.value=l.key},[t("span",pt,S(l.icon),1),t("span",ht,S(p(ke)(l,p(x))),1)],10,ut))),128))]),t("div",mt,[t("div",xt,[(d(!0),c(ee,null,se(A.value,l=>(d(),c("button",{key:l.latex,class:"symbol-button",onClick:U=>ne(l.latex),title:p(oe)(l,p(x))},[l.display?(d(),c("span",{key:0,innerHTML:l.display},null,8,vt)):(d(),c("span",gt,S(l.latex),1))],8,yt))),128))]),B.value==="basic"&&n.showFormulaExamples?(d(),c("div",Ct,[t("div",ft,[r[17]||(r[17]=t("span",{class:"icon"},"⭐",-1)),t("span",null,S(p(s).beautiful.categories.formulas),1)]),t("div",St,[(d(!0),c(ee,null,se(D.value,l=>(d(),c("button",{key:l.latex,class:"example-button",onClick:U=>ne(l.latex),title:p(oe)(l,p(x))},[t("div",{class:"example-preview",innerHTML:l.display},null,8,Nt),t("div",Ut,S(p(oe)(l,p(x))),1)],8,bt))),128))])])):y("",!0)])])):y("",!0)]),t("div",zt,[t("button",{class:"btn btn-secondary",onClick:ie},S(p(s).beautiful.cancelButton),1),t("button",{class:"btn btn-primary",onClick:ue,disabled:!C.value||n.readonly},S(p(s).beautiful.insertButton),9,wt)])],6)],2)):y("",!0)]))],64))}}),Tt={key:0,class:"format-group"},Mt=["title"],Lt=["title"],At=["title"],_t=["title"],Pt={key:1,class:"divider"},Bt={key:2,class:"math-group"},$t=["title"],Et={key:3,class:"divider"},It={key:4,class:"insert-group"},Ft=["accept"],qt=["disabled","title"],Rt={key:0,class:"loading-icon"},Ht={key:1,class:"icon"},Dt={key:2,class:"divider"},Jt=["title","disabled"],jt={key:4,class:"divider"},Vt=["title"],Ot={key:6,class:"divider"},Gt=["title"],Xt={class:"icon"},Wt={class:"editor-container"},Kt=["contenteditable","spellcheck","placeholder"],Qt={key:0,class:"char-counter"},Zt={key:0,class:"limit-info"},Yt=Te({__name:"index",props:{modelValue:{default:""},placeholder:{default:""},minHeight:{default:"300px"},maxHeight:{default:"none"},width:{default:"100%"},borderRadius:{default:"12px"},showToolbar:{type:Boolean,default:!0},toolbarPosition:{default:"top"},enabledTools:{default:()=>["bold","italic","underline","strikethrough","formula","image","clear","theme"]},enableBold:{type:Boolean,default:!0},enableItalic:{type:Boolean,default:!0},enableUnderline:{type:Boolean,default:!0},enableStrikethrough:{type:Boolean,default:!0},enableFormula:{type:Boolean,default:!0},enableImage:{type:Boolean,default:!0},enableClearFormat:{type:Boolean,default:!0},enableThemeToggle:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},autoFocus:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!0},maxLength:{default:1e4},theme:{default:"light"},showCharCount:{type:Boolean,default:!0},showWordCount:{type:Boolean,default:!1},enableShortcuts:{type:Boolean,default:!0},enableAutoSave:{type:Boolean,default:!1},autoSaveInterval:{default:3e4},formulaEditorProps:{default:()=>({})},maxImageSize:{default:5242880},allowedImageTypes:{default:()=>["image/jpeg","image/png","image/gif","image/webp"]},customClass:{default:""},toolbarClass:{default:""},editorClass:{default:""}},emits:["update:modelValue","change","focus","blur","ready","error","themeChange","formatToggle","imageUpload","imageUploaded","imageError","formulaInsert","save","charLimitReached","wordCountChange","charCountChange"],setup(u,{emit:g}){const e=u,o=g,{t:s,locale:x,setLocale:k,availableLocales:P}=_e(),h=z(),C=z(),B=z(!1),I=z(""),M=z(null),de=z(!1),H=z(""),V=z(0),D=z(0),K=z(!1),A=z(new Set),Q=z(null),te=z(""),$=z(e.theme||"light"),le=z(!1),ye=E(()=>$.value==="dark"?"☀️":"🌙");E(()=>$.value==="dark"?"切换到亮色主题":"切换到暗色主题");const ie=E(()=>{const a={minHeight:e.minHeight,width:e.width,borderRadius:e.borderRadius};return e.maxHeight!=="none"&&(a.maxHeight=e.maxHeight),a}),v=a=>{if(!e.enabledTools.includes(a))return!1;switch(a){case"bold":return e.enableBold;case"italic":return e.enableItalic;case"underline":return e.enableUnderline;case"strikethrough":return e.enableStrikethrough;case"formula":return e.enableFormula;case"image":return e.enableImage;case"clear":return e.enableClearFormat;case"theme":return e.enableThemeToggle;default:return!0}},ne=E(()=>e.toolbarPosition==="bottom"?"toolbar-bottom":"toolbar-top"),Z=E(()=>{const a=[];return e.showCharCount&&a.push(`${V.value} ${s.value.editor.stats.characters}`),e.showWordCount&&a.push(`${D.value} ${s.value.editor.stats.words}`),a.join(" · ")}),ue=E(()=>e.enableAutoSave&&H.value!==te.value),pe=E(()=>e.placeholder||s.value.editor.placeholder),J=E(()=>e.enableShortcuts?{bold:s.value.editor.shortcuts.bold,italic:s.value.editor.shortcuts.italic,underline:s.value.editor.shortcuts.underline,strikethrough:s.value.editor.toolbar.strikethrough+" - 点击激活后，输入的文本将自动应用此格式",formula:s.value.editor.toolbar.formula,image:s.value.editor.toolbar.image,clear:s.value.editor.shortcuts.clear,theme:x.value==="zh-CN"?$.value==="dark"?"切换到亮色主题":"切换到暗色主题":$.value==="dark"?"Switch to Light Theme":"Switch to Dark Theme"}:{bold:s.value.editor.toolbar.bold+" - 点击激活后，输入的文本将自动应用此格式",italic:s.value.editor.toolbar.italic+" - 点击激活后，输入的文本将自动应用此格式",underline:s.value.editor.toolbar.underline+" - 点击激活后，输入的文本将自动应用此格式",strikethrough:s.value.editor.toolbar.strikethrough+" - 点击激活后，输入的文本将自动应用此格式",formula:s.value.editor.toolbar.formula,image:s.value.editor.toolbar.image,clear:s.value.editor.toolbar.clear,theme:x.value==="zh-CN"?$.value==="dark"?"切换到亮色主题":"切换到暗色主题":$.value==="dark"?"Switch to Light Theme":"Switch to Dark Theme"});G(()=>e.modelValue,async a=>{if(a!==H.value&&h.value){H.value=a||"";const i=await re(a||"");h.value.innerHTML=i,ve(),await ae(),ce()}},{immediate:!0}),G(()=>e.theme,a=>{le.value||($.value=a)},{immediate:!0}),G($,(a,i)=>{i!==void 0&&(le.value=!0)});const re=async a=>{if(!a)return"";let i=a;/<svg[^>]*data-latex[^>]*>/i.test(i)&&(i=Ae(i)),i=i.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/__(.*?)__/g,"<u>$1</u>").replace(/~~(.*?)~~/g,"<s>$1</s>").replace(/!\[([^\]]*)\]\(([^)]*)\)/g,'<img src="$2" alt="$1" style="max-width: 100%; height: auto; margin: 8px 0; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">').replace(/\n/g,"<br>");try{i=await we(i)}catch(m){console.warn("LaTeX conversion failed:",m)}return i},he=a=>{const i=a.cloneNode(!0);return i.querySelectorAll("svg[data-latex]").forEach(m=>{var f;const N=m.getAttribute("data-latex")||"";if(N){const b=m.getAttribute("data-latex-type");let w;b==="inline"?w=`$${N}$`:w=`$$${N}$$`;const j=document.createTextNode(w);(f=m.parentNode)==null||f.replaceChild(j,m)}}),i.innerHTML},X=a=>A.value.has(a),O=a=>{if(!(!h.value||e.readonly)){switch(a){case"bold":if(!e.enableBold)return;break;case"italic":if(!e.enableItalic)return;break;case"underline":if(!e.enableUnderline)return;break;case"strikethrough":if(!e.enableStrikethrough)return;break}try{const i=window.getSelection();if(!i||i.rangeCount===0)return;i.getRangeAt(0).collapsed?A.value.has(a)?(A.value.clear(),o("formatToggle",a,!1)):(A.value.clear(),A.value.add(a),o("formatToggle",a,!0)):(document.execCommand(a,!1),A.value.clear(),o("formatToggle",a,!0)),h.value.focus(),W()}catch(i){console.warn("切换格式失败:",i),o("error",i)}}},me=()=>{const a=["bold","italic","underline","strikethrough"];if(A.value.size===0){const i=window.getSelection();i&&i.rangeCount>0&&i.getRangeAt(0).collapsed&&a.forEach(m=>{document.queryCommandState(m)})}},n=a=>{const i=a;if(A.value.size>0&&i.inputType==="insertText"&&i.data){a.preventDefault();let m=i.data;const f=Array.from(A.value),N=[];let b={start:"",end:""};f.forEach(j=>{switch(j){case"bold":b.start=`<strong>${b.start}`,b.end=`${b.end}</strong>`;break;case"italic":b.start=`<em>${b.start}`,b.end=`${b.end}</em>`;break;case"underline":b.start=`<u>${b.start}`,b.end=`${b.end}</u>`;break;case"strikethrough":b.start=`<s>${b.start}`,b.end=`${b.end}</s>`;break}}),N.length>0&&(m=`<span style="${N.join("; ")}">${m}</span>`),m=b.start+m+b.end;const w=window.getSelection();if(w&&w.rangeCount>0){const j=w.getRangeAt(0);j.deleteContents();const Y=document.createElement("div");Y.innerHTML=m;const T=document.createDocumentFragment();for(;Y.firstChild;)T.appendChild(Y.firstChild);j.insertNode(T),j.collapse(!1),w.removeAllRanges(),w==null||w.addRange(j)}W()}},r=()=>{if(!h.value)return;const a=window.getSelection();!a||a.rangeCount===0||(a.getRangeAt(0).collapsed||A.value.clear(),me())},l=async a=>{var i,m;if(h.value)try{if((i=window.MathJax)!=null&&i.tex2svgPromise||await xe(),!((m=window.MathJax)!=null&&m.tex2svgPromise))throw new Error("MathJax初始化失败，无法渲染公式");const f=await we(`$$${a}$$`);h.value.focus(),M.value&&(M.value.remove(),M.value=null),document.execCommand("insertHTML",!1,f),W(),await ae(),ce(),o("formulaInsert",a)}catch(f){console.error("插入公式失败:",f);try{h.value.focus(),document.execCommand("insertHTML",!1,`$$${a}$$`),W()}catch(N){console.error("备用插入也失败:",N)}}},U=()=>{!e.enableFormula||e.readonly||(B.value=!0,I.value="",M.value=null)},L=a=>{const i=a.getAttribute("data-latex");i&&(I.value=i,M.value=a,B.value=!0)},ce=()=>{h.value&&h.value.querySelectorAll("svg[data-latex]").forEach(a=>{const i=a;i.onclick=m=>{m.preventDefault(),m.stopPropagation(),L(i)}})},fe=async a=>{var i;const m=a.target,f=(i=m.files)==null?void 0:i[0];if(!(!f||!h.value||e.readonly||!e.enableImage)){if(!e.allowedImageTypes.includes(f.type)){const N=`不支持的文件类型: ${f.type}`;o("imageError",N),m.value="";return}if(f.size>e.maxImageSize){const N=`文件过大: ${(f.size/1024/1024).toFixed(2)}MB，最大允许: ${(e.maxImageSize/1024/1024).toFixed(2)}MB`;o("imageError",N),m.value="";return}K.value=!0,o("imageUpload",f);try{const N=URL.createObjectURL(f),b=`<img src="${N}" alt="${f.name}" style="max-width: 100%; height: auto; margin: 8px 0; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" />`;h.value.focus(),document.execCommand("insertHTML",!1,b),o("imageUploaded",N),W()}catch(N){console.error("图片上传失败:",N),o("imageError",N instanceof Error?N.message:"图片上传失败"),o("error",N)}finally{K.value=!1,m.value=""}}},Be=async()=>{if(!(!h.value||e.readonly||!e.enableClearFormat))try{const a=window.getSelection();if(!a||a.rangeCount===0){A.value.clear(),h.value.focus();return}const i=a.getRangeAt(0);if(i.collapsed){A.value.clear(),h.value.focus();return}await $e(i),A.value.clear(),h.value.focus(),W()}catch(a){console.warn("清除格式失败:",a)}},$e=async a=>{if(!h.value)return;const i=a.extractContents(),m=document.createElement("div");m.appendChild(i);const f=[],N=[];m.querySelectorAll("svg[data-latex]").forEach((T,_)=>{var F;const q=document.createTextNode(`__FORMULA_${_}__`);f.push({element:T.cloneNode(!0),placeholder:q}),(F=T.parentNode)==null||F.replaceChild(q,T)}),m.querySelectorAll(".math-formula").forEach((T,_)=>{var F;const q=document.createTextNode(`__SPAN_FORMULA_${_}__`);f.push({element:T.cloneNode(!0),placeholder:q}),(F=T.parentNode)==null||F.replaceChild(q,T)}),m.querySelectorAll("img").forEach((T,_)=>{var F;const q=document.createTextNode(`__IMAGE_${_}__`);N.push({element:T.cloneNode(!0),placeholder:q}),(F=T.parentNode)==null||F.replaceChild(q,T)});let b=m.textContent||"";f.forEach(({placeholder:T},_)=>{b=b.replace(`__FORMULA_${_}__`,`__FORMULA_${_}__`),b=b.replace(`__SPAN_FORMULA_${_}__`,`__SPAN_FORMULA_${_}__`)}),N.forEach(({placeholder:T},_)=>{b=b.replace(`__IMAGE_${_}__`,`__IMAGE_${_}__`)});const w=document.createElement("div");w.textContent=b,f.forEach(({element:T},_)=>{var F,q;const Se=`__FORMULA_${_}__`,be=`__SPAN_FORMULA_${_}__`;(F=w.textContent)!=null&&F.includes(Se)&&(w.innerHTML=w.innerHTML.replace(Se,T.outerHTML)),(q=w.textContent)!=null&&q.includes(be)&&(w.innerHTML=w.innerHTML.replace(be,T.outerHTML))}),N.forEach(({element:T},_)=>{var F;const q=`__IMAGE_${_}__`;(F=w.textContent)!=null&&F.includes(q)&&(w.innerHTML=w.innerHTML.replace(q,T.outerHTML))});const j=document.createDocumentFragment();for(;w.firstChild;)j.appendChild(w.firstChild);a.insertNode(j),a.collapse(!1);const Y=window.getSelection();Y&&(Y.removeAllRanges(),Y.addRange(a)),await ae(),ce()},Ee=()=>{if(!e.enableThemeToggle)return;const a=$.value==="dark"?"light":"dark";$.value=a,le.value=!0,o("themeChange",a)},Ie=()=>{const a=x.value==="zh-CN"?"en-US":"zh-CN";k(a)},ve=()=>{if(!h.value)return;const a=h.value.textContent||"",i=V.value,m=D.value;V.value=a.length,D.value=a.trim()?a.trim().split(/\s+/).length:0,V.value!==i&&o("charCountChange",V.value),D.value!==m&&o("wordCountChange",D.value),e.maxLength&&V.value>=e.maxLength&&o("charLimitReached")},W=()=>{if(!h.value)return;if(e.maxLength&&h.value.textContent&&h.value.textContent.length>e.maxLength){const i=h.value.textContent.substring(0,e.maxLength);h.value.textContent=i;const m=document.createRange(),f=window.getSelection();m.selectNodeContents(h.value),m.collapse(!1),f==null||f.removeAllRanges(),f==null||f.addRange(m)}const a=he(h.value);H.value=a,o("update:modelValue",a),o("change",a),ve(),e.enableAutoSave&&(Q.value&&window.clearTimeout(Q.value),Q.value=window.setTimeout(()=>{ue.value&&(te.value=H.value,o("save",H.value))},e.autoSaveInterval))},Fe=a=>{if(!e.readonly){if(a.key==="Escape"){A.value.clear(),r();return}if(e.enableShortcuts&&(a.ctrlKey||a.metaKey))switch(a.key){case"b":e.enableBold&&(a.preventDefault(),O("bold"));break;case"i":e.enableItalic&&(a.preventDefault(),O("italic"));break;case"u":e.enableUnderline&&(a.preventDefault(),O("underline"));break;case"s":e.enableAutoSave&&(a.preventDefault(),te.value=H.value,o("save",H.value));break}["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(a.key)&&setTimeout(()=>{A.value.clear(),r()},0)}},qe=async a=>{a.preventDefault();const i=a.clipboardData;if(!i||!h.value)return;const m=i.getData("text/plain");if(m)try{const N=await re(m);document.execCommand("insertHTML",!1,N),W(),ce()}catch{document.execCommand("insertText",!1,m)}const f=i.items;for(let N=0;N<f.length;N++)if(f[N].type.indexOf("image")!==-1){const b=f[N].getAsFile();b&&await fe({target:{files:[b]}})}},Re=()=>{o("focus")},He=()=>{o("blur")};return Me(async()=>{try{if(await xe(),e.modelValue&&h.value){const a=await re(e.modelValue);h.value.innerHTML=a,await ae(),ce()}ve(),e.autoFocus&&h.value&&h.value.focus(),o("ready")}catch(a){console.error("VueMathjaxEditor初始化失败:",a),o("error",a)}}),je(()=>{Q.value&&window.clearTimeout(Q.value)}),(a,i)=>(d(),c("div",{class:R(["vue-mathjax-editor",[{"full-screen":de.value,"theme-dark":$.value==="dark","theme-light":$.value==="light"},ne.value,e.customClass]]),style:Ce(ie.value)},[a.showToolbar?(d(),c("div",{key:0,class:R(["toolbar",e.toolbarClass])},[v("bold")||v("italic")||v("underline")||v("strikethrough")?(d(),c("div",Tt,[v("bold")?(d(),c("button",{key:0,class:R(["toolbar-btn",{active:X("bold")}]),onClick:i[0]||(i[0]=m=>O("bold")),title:J.value.bold},i[6]||(i[6]=[t("strong",null,"B",-1)]),10,Mt)):y("",!0),v("italic")?(d(),c("button",{key:1,class:R(["toolbar-btn",{active:X("italic")}]),onClick:i[1]||(i[1]=m=>O("italic")),title:J.value.italic},i[7]||(i[7]=[t("em",null,"I",-1)]),10,Lt)):y("",!0),v("underline")?(d(),c("button",{key:2,class:R(["toolbar-btn",{active:X("underline")}]),onClick:i[2]||(i[2]=m=>O("underline")),title:J.value.underline},i[8]||(i[8]=[t("u",null,"U",-1)]),10,At)):y("",!0),v("strikethrough")?(d(),c("button",{key:3,class:R(["toolbar-btn",{active:X("strikethrough")}]),onClick:i[3]||(i[3]=m=>O("strikethrough")),title:J.value.strikethrough},i[9]||(i[9]=[t("s",null,"S",-1)]),10,_t)):y("",!0)])):y("",!0),(v("bold")||v("italic")||v("underline")||v("strikethrough"))&&v("formula")?(d(),c("div",Pt)):y("",!0),v("formula")?(d(),c("div",Bt,[t("button",{class:"toolbar-btn formula-btn",onClick:U,title:J.value.formula},[i[10]||(i[10]=t("span",{class:"fx-icon"},"fx",-1)),t("span",null,S(p(s).editor.toolbar.formulaShort),1)],8,$t)])):y("",!0),v("formula")&&(v("image")||v("clear")||v("theme"))?(d(),c("div",Et)):y("",!0),v("image")||v("clear")||v("theme")?(d(),c("div",It,[v("image")?(d(),c("input",{key:0,ref_key:"imageInput",ref:C,type:"file",accept:e.allowedImageTypes.join(","),onChange:fe,style:{display:"none"}},null,40,Ft)):y("",!0),v("image")?(d(),c("button",{key:1,class:"toolbar-btn image-btn",onClick:i[4]||(i[4]=m=>{var f;return(f=C.value)==null?void 0:f.click()}),disabled:K.value||e.readonly,title:J.value.image},[K.value?(d(),c("span",Rt,"⟳")):(d(),c("span",Ht,"🖼️")),t("span",null,S(p(s).editor.toolbar.imageShort),1)],8,qt)):y("",!0),v("image")&&(v("clear")||v("theme"))?(d(),c("div",Dt)):y("",!0),v("clear")?(d(),c("button",{key:3,class:"toolbar-btn clear-btn",onClick:Be,title:J.value.clear,disabled:e.readonly},[i[11]||(i[11]=t("span",{class:"icon"},"🧹",-1)),t("span",null,S(p(s).editor.toolbar.clearShort),1)],8,Jt)):y("",!0),v("clear")&&(v("theme")||p(P).length>1)?(d(),c("div",jt)):y("",!0),p(P).length>1?(d(),c("button",{key:5,class:"toolbar-btn language-btn",onClick:Ie,title:p(x)==="zh-CN"?"Switch to English":"切换到中文"},[i[12]||(i[12]=t("span",{class:"icon"},"🌐",-1)),t("span",null,S(p(x)==="zh-CN"?"中":"EN"),1)],8,Vt)):y("",!0),p(P).length>1&&v("theme")?(d(),c("div",Ot)):y("",!0),v("theme")?(d(),c("button",{key:7,class:"toolbar-btn theme-btn",onClick:Ee,title:J.value.theme},[t("span",Xt,S(ye.value),1),t("span",null,S(p(s).editor.toolbar.theme),1)],8,Gt)):y("",!0)])):y("",!0)],2)):y("",!0),t("div",Wt,[t("div",{ref_key:"editorRef",ref:h,class:R(["editor-content",e.editorClass]),contenteditable:!e.readonly,spellcheck:e.spellcheck,onInput:W,onBeforeinput:n,onKeydown:Fe,onPaste:qe,onFocus:Re,onBlur:He,onMouseup:r,onKeyup:r,placeholder:pe.value,style:Ce({minHeight:a.minHeight,maxHeight:e.maxHeight!=="none"?e.maxHeight:void 0})},null,46,Kt),e.showCharCount||e.showWordCount?(d(),c("div",Qt,[t("span",null,S(Z.value),1),e.maxLength?(d(),c("span",Zt,"/ "+S(e.maxLength),1)):y("",!0)])):y("",!0)]),e.enableFormula?(d(),Le(kt,Ve({key:1,modelValue:B.value,"onUpdate:modelValue":i[5]||(i[5]=m=>B.value=m),"existing-latex":I.value,theme:$.value},e.formulaEditorProps,{onInsert:l}),null,16,["modelValue","existing-latex","theme"])):y("",!0)],6))}}),el=(u,g)=>{const e=u.__vccOpts||u;for(const[o,s]of g)e[o]=s;return e},tl=el(Yt,[["__scopeId","data-v-97edae9b"]]);export{kt as N,we as b,tl as q,xe as y};
